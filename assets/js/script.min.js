function loadPage(){let content=document.querySelector("#content"),title=document.querySelector("title");let data=htmlToElement(httpGet("./pages/"+page+".html"));dataIncludeReplace(data);content.innerHTML=data.body.innerHTML;let subpage=data.querySelector("title")?data.querySelector("title").textContent:"error";title.textContent=title.textContent.split(" - ")[0]+" - "+subpage;if(backgroundProcesses.length){for(let backgroundProcess of backgroundProcesses){clearInterval(backgroundProcess)}backgroundProcesses=[]}if(typeof window[page]==="undefined"){let scripts=data.getElementsByTagName("script");for(let script of scripts){getScript(script.src)}}let i=0;let pageLoad=setInterval(()=>{if(typeof window[page]!=="undefined"){clearInterval(pageLoad);window[page]()}else if(i>3){clearInterval(pageLoad);console.log("Function not implemented.")}i++},100)}function getScript(source){let script=document.createElement("script");let prior=document.querySelectorAll("body script:last-child")[0];script.async=true;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;script=undefined}};script.src=source;prior.parentNode.insertBefore(script,prior);prior.remove()}function getPage(){let hash=window.location.hash;let match=hash.match("page=[^&]*");if(match)return match[0].split("=")[1];return"home"}window.addEventListener("scroll",()=>{let navbar=document.querySelector("#navbar");if(window.scrollY===0){navbar.classList.remove("shadow")}else{navbar.classList.add("shadow")}});window.addEventListener("resize",function(){removeControls("controlsContent");removeControls("controlsQueue")},true);bindEvent("click","[data-page]",function(e){e.preventDefault();let navigation=document.querySelector("#navigation");if(navigation.classList.contains("show"))navigation.classList.remove("show");let queueView=document.querySelector("#queueView");if(queueView.classList.contains("show")){let body=document.getElementsByTagName("body")[0];let angleIcon=document.getElementsByClassName("fa-angle-up")[0];hidePlaylist(body,queueView,angleIcon)}page=e.target.dataset.page;prevPage=undefined;window.location.href="#!page="+page;loadPage();setActiveNavbar()});bindEvent("click","#navbar-toggler",function(){let navigation=document.querySelector("#navigation");if(navigation.classList.contains("show"))navigation.classList.remove("show");else navigation.classList.add("show")});bindEvent("click","#player .fa-pause",()=>pauseSong());bindEvent("click","#player .fa-play",()=>play());bindEvent("touchstart","#timeline",()=>onTimelinePress());bindEvent("mousedown","#timeline",()=>onTimelinePress());bindEvent("input","#timeline",e=>onTimelineMove(e));bindEvent("click","[data-title]",function(){if(!isTouchScreen()||touched){let element=this;setTimeout(function(){if(currentHover===element){touched=false;showNotification(element.getAttribute("data-title"),3e3)}},200)}else touched=true});document.getElementById("queue").onscroll=function(){removeControls("controlsQueue")};bindEvent("mouseover","#queueView tr[data-id]",function(){let controls=this.querySelector(".controlsQueue");if(!controls){removeControls("controlsQueue");controls=createControls("controlsQueue",["play"]);let pos=this.getBoundingClientRect();controls.style.top="3px";controls.style.right="0";controls.style.height=pos.height-6+"px";controls.style.lineHeight=pos.height-6+"px";controls.setAttribute("data-id",this.getAttribute("data-id"));setTimeout(()=>{this.querySelector("td:last-of-type").appendChild(controls);controls.classList.add("show")},50)}else clearTimeout(controlsTimeout)});bindEvent("mouseout","#queueView tr[data-id]",function(){let row=this;controlsTimeout=setTimeout(function(){if(row!==currentHover.closest("tr")){touched=false;let controls=row.querySelector(".controlsQueue");if(controls)controls.remove()}},0)});bindEvent("input","#search",function(){if(page!=="music")prevPage=getPage();if(this.value||typeof prevPage==="undefined")page="music";else page=prevPage;window.location.href="#!page="+page;loadPage()});bindEvent("keyup","#search",function(e){if(e.keyCode===13){e.preventDefault();let navigation=document.querySelector("#navigation");if(navigation.classList.contains("show"))navigation.classList.remove("show")}});bindEvent("click","#view .fa-list",function(){setCookie("view","list");loadPage()});bindEvent("click","#view .fa-grip-horizontal",function(){setCookie("view","grid");loadPage()});bindEvent("click","#theme-toggler",function(){let html=document.getElementsByTagName("html")[0],icon=this.querySelector("svg");if(html.getAttribute("data-theme")==="dark"){html.setAttribute("data-theme","light");icon.classList.remove("fa-sun");icon.classList.add("fa-moon");theme="light";setCookie("theme","light")}else{html.setAttribute("data-theme","dark");icon.classList.remove("fa-moon");icon.classList.add("fa-sun");theme="dark";setCookie("theme","dark")}});bindEvent("click",".repeat",function(){switch(repeatMode){case 0:repeatMode=1;this.style.color="#1d93ff";break;case 1:repeatMode=2;this.querySelector(".repeatOne").classList.add("show");break;case 2:repeatMode=0;this.style.color="unset";this.querySelector(".repeatOne").classList.remove("show");break}});bindEvent("mouseover",".volume",function(){document.getElementsByClassName("volumeBackground")[0].classList.add("show");hideVolumeSlider()});bindEvent("mouseout",".volume",function(){document.getElementsByClassName("volumeBackground")[0].classList.remove("show")});bindEvent("input",".volumeSlider",function(){let volumeSlider=this;volume=volumeSlider.value/100;previousVolume=null;playlist[playIndex]["player"].setGain(volume*65535);let volumeIcon=prev(volumeSlider.closest(".volumeBackground"));setVolumeIcon(volumeIcon,volumeSlider);setCookie("volume",volume);hideVolumeSlider()});bindEvent("click",".volume",function(e){if(!isTouchScreen()||touched){let volumeIcon=this.querySelector("svg"),volumeSlider=this.querySelector(".volumeSlider");if(e.target===volumeSlider)return;if(previousVolume){volumeSlider.value=previousVolume*100;setVolumeIcon(volumeIcon,volumeSlider);volume=previousVolume;previousVolume=null}else{volumeIcon.classList.remove("fa-volume-*");volumeIcon.classList.add("fa-volume-mute");previousVolume=volume;volumeSlider.value=volume=0}playlist[playIndex]["player"].setGain(volume*65535);hideVolumeSlider()}else touched=true});let iconInterval=setInterval(function(){let icon=document.getElementById("theme-toggler").querySelector("svg");if(icon){if(theme==="light")icon.classList.add("fa-moon");else icon.classList.add("fa-sun");clearInterval(iconInterval)}},50);page=getPage();window.location.href="#!page="+page;loadPage();dataIncludeReplace(document.body);setActiveNavbar();